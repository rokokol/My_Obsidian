#math #algorithms 
## Что такое схема Горнера?

> [!INFO]
> В общем, это всем известный алгоритм, созданный для решения [[полинома]] $Pn(x)$ при определенном $x = х_0$

Пусть дан вот такой полином $Pn(x)$:

$Pn(x) = a_0x^n + a_1x^{n-1} + ... + a_{n-1}x^1 + a_n,  a_0 \neq 0$

И, чтобы найти частное от деление этого многочлена на $x = x_0$ мы можем просто поделить "уголком", что, на самом деле, не шибко удобно, ведь для деления конкретно на одночлены и применяется более удобная **схема Горнера**:

|       |    $a_0$    |        $a_1$         | $a_2$                | $...$ |            $a_n$             |
|:-----:|:-----------:|:--------------------:| -------------------- |:-----:|:----------------------------:|
| $x_0$ | $b_0 = a_0$ | $b_1 = x_0b_0 + a_1$ | $b_2 = x_0b_1 + a_2$ | $...$ | $r = b_n = x_0b_{n-1} + a_n$ |

>[!EXAMPLE]
>Дан многочлен $Pn(x) = x^4 - 9x^2 + 4x + 12$
>Найти частное при делении этого многочлена на $x_0 = -2$
>*Решение*:
>
|      | $1$ | $0$  | $-9$ | $4$  | $12$  |
| ---- |:---:|:----:|:----:|:----:|:-----:|
| $-2$ | $1$ | $-2$ | $-5$ | $14$ | $-16$ | 
>*Ответ*:
>$Pn(x) = (x + 2)(x^3 - 2x^2 - 5x + 14) - 16$

>[!NOTE]
>Также с помощью схемы Горнера можно узнать [[производную]] порядка $n$ многочлена $Pn(x)$ (но об этом как-нибудь в другой раз)

И схема на самом деле удобная. Но вы никогда не задумывались, почему она работает именно так? Как она устроена?

Я тоже задался таким вопросом и ответ был прост, пускай и не столь очевиден. Дело в том, что мы не делим многочлен $Pn(x)$ на одночлен $x - x_0$, как это было в случае с тем самым уголком. Мы сразу находим *частное* от деления

>[!PROOF]
>Как это доказать?
>
>1. Пускай $Pn(x)$ можно представить в виде (где r - это остаток от деления):
>$a_0x^n + a_1x^{n-1} + ... + a_{n-1}x^1 + a_n = (x - x_0)(b_0x^{n-1} + b_1x^{n-2} + ... + b_{n-1}) + r$
>
> 2. Тогда частным будет многочлен
>$O(x) = b_0x^{n-1} + b_1x^{n-2} + ... + b_{n-1}$
>
>3. Раскроем скобки и получим:
>$a_0x^n + a_1x^{n-1} + ... + a_{n-1}x^1 + a_n = b_0x^n + b_1x^{n-1} + ... + b_nx^1 - x_0b_0x^{n-1} - x_0b_1x^{n-2} - ... - x_0b_{n-1} + r$
>
>4. Теперь ситуация прояснилась: мы можем поставить в соответствие каждому $b_ix^j$ соответствующее число, умноженное на такой же $x^j$:
>
>	|   $b_ix^j$   |    соответствующее число     | комментарий | 
>	|:------------:|:----------------------------:|:-----------:|
>	|   $b_0x^n$   |           $a_0x^n$           |        *у нас есть только 1 множитель, содержащий* $x^n$     |
>	| $b_1x^{n-1}$ | $a_1x^{n-1} + x_0b_0x^{n-1}$ |      *переносим отрицательный $x_0b_1x^{n-1}$ в левую часть, сопоставляем с оставшимся положительным $b_1x^{n-1}$ в правой части, который тоже имеет $x^{n-1}$*      |
>	|    $...$     |            $...$             |      *повторяем предыдущую операцию необходимое количество раз*       |
>	|   $b_{n-1}x^1$   | $a_{n-1}x^1 + x_0b_{n-1}x^1$ |     *последние слагаемые, имеющие множитель $x$*        |
>	|     $r$      |        $a_n + x_0b_{n-1}$        |        *как мы помним, у нас был член $r$, который, естественно, не имел множителя $x$. Мы можем сопоставить его с оставшимися слагаемыми, которые тоже не имеют при себе $x$*     |
>
>5. Замечательно! Мы можем заметить, что кроме этого, в каждой строке нашей таблицы имеются общие множители $x^i$. Давайте сократим их:
>
>	|   $b_ix^j$   |    соответствующее число     | комментарий |
>	|:------------:|:----------------------------:| ----------- |
>	|   $b_0$   |           $a_0$           |     *сокращаем на x^n*       |
>	| $b_1$ | $a_1 + x_0b_0$ |      *сокращаем на x^{n-1}*       |
>	|    $...$     |            $...$             |        *повторяем необходимое количество раз*     |
>	|   $b_{n-1}$   | $a_{n-1} + x_0b_{n-2}$ |     *сокращаем на x^1*        |
>	|     $r$      |        $a_n + x_0b_{n-1}$        |       *а тут сокращать не на что (естественно, мы не берем в расчет $x^0 = 1$*)      |
>
>6. Возможно, вы уже заметили, что схема выше - это и есть та самая **схема Горнера**, только  повернутая на бок. Доказательство окончено

Блеск! Мы справились: повторили и доказали этот пускай обыденный, но при этом необычный алгоритм
